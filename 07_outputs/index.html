<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PS70: Intro to Digital Fabrication — Week 7 (Electronic Outputs)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../style.css" rel="stylesheet">
</head>

<body>
  <!-- Top Header (colors unchanged) -->
  <nav class="navbar navbar-expand-sm navbar-dark" style=" color: #EEE7E8;">
    <div class="container-fluid" style="align-items: center; justify-content: center;">
      <div class="flexrow">
        <h2 class="nav-title">Digital Fabrication - Summer 2025</h2>
      </div>
      <div class="navbar-nav">
        <h4><a class="nav-link" href="../index.html">Home</a></h4>
        <h4><a class="nav-link" href="../about.html">About</a></h4>
      </div>
    </div>
  </nav>

  <main class="container py-4 page">
    <header class="mb-3">
      <h3>Week 7: Electronic Outputs</h3>
    </header>

    <!-- Intro -->
    <section class="mb-4" aria-label="Overview">
      <p class="h6 lh-base">
        This week was a grind in the best way. It may not look like huge progress, but I spent
        a ton of hours wiring, testing, and learning-by-doing — and I’m proud of it. Big thanks
        to Bobby for the guidance. This was my first time hooking up a new tool on a breadboard
        and coding it from scratch. I made my fair share of rookie mistakes, but I’m already
        avoiding those pitfalls now.
      </p>
    </section>

    <!-- Hero image -->
    <section class="mb-4" aria-label="Build Photos">
      <figure class="mb-3">
        <img src="./1.png" alt="Breadboarded setup progress shot" class="img-card img-fluid" loading="lazy">
      </figure>

      <div class="row gallery-gap">
        <div class="col-12 col-md-4">
          <figure><img src="./2.png" alt="Close-up wiring 1" class="img-card img-fluid" loading="lazy"></figure>
        </div>
        <div class="col-12 col-md-4">
          <figure><img src="./3.png" alt="Close-up wiring 2" class="img-card img-fluid" loading="lazy"></figure>
        </div>
        <div class="col-12 col-md-4">
          <figure><img src="./ku.png" alt="Component layout" class="img-card img-fluid" loading="lazy"></figure>
        </div>
      </div>
    </section>

    <!-- Section 1: Enclosure -->
    <section class="mb-4" aria-label="Teddy Box Design">
      <h4 class="mb-2">1) Designing the Teddy Box (Fusion 360 + Laser Cutting)</h4>
      <p class="h6 lh-base">
        I’m sketching a smarter, more space-efficient pocket case to hold the breadboard and charger
        while keeping things fun and minimal. I’ll prototype in cardboard, then move to acrylic or
        wood. Planned features include:
      </p>
      <ul class="h6">
        <li>Front LCD window</li>
        <li>USB-C port opening</li>
        <li>Optional pause / reset buttons</li>
      </ul>

      <div class="row gallery-gap">
        <div class="col-12 col-md-6 col-lg-4">
          <figure><img src="./4.png" alt="Fusion 360 planning" class="img-card img-fluid" loading="lazy"></figure>
        </div>
      </div>
    </section>

    <!-- Section 2: Input Device -->
    <section class="mb-4" aria-label="Input Device">
      <h4 class="mb-2">2) Input Device: Wireless Phone Charger as Sensor</h4>

      <div class="row">
        <div class="col-12 col-lg-6">
          <p class="h6 lh-base mb-2"><strong>Objective:</strong> Use the charger’s analog output to detect when a phone is actually charging (not just nearby).</p>
          <p class="h6 lh-base mb-2"><strong>Materials:</strong> Wireless charger module (5V), ESP32 Dev Board, jumper wires.</p>
          <p class="h6 lh-base mb-2"><strong>Wiring:</strong></p>
          <ul class="h6">
            <li>Charger analog signal → ESP32 <code>pin 14 (ADC)</code></li>
            <li>Charger VCC → ESP32 <code>5V</code></li>
            <li>Charger GND → ESP32 <code>GND</code></li>
          </ul>
          <p class="h6 lh-base">
            <strong>Logic:</strong> sample the analog value repeatedly, apply a rolling average, and only confirm
            “charging” when the readings are stable (around the known threshold). The timer starts
            only when charging is confirmed — core to my project. It works well overall; occasional
            spikes still happen, so I’ll keep improving the filter.
          </p>
        </div>
        <div class="col-12 col-lg-6">
          <div class="row gallery-gap">
            <div class="col-6">
              <figure><img src="./10.png" alt="Signal pin probing" class="img-card img-fluid" loading="lazy"></figure>
            </div>
            <div class="col-6">
              <figure><img src="./20.png" alt="Breadboard with charger module" class="img-card img-fluid" loading="lazy"></figure>
            </div>
            <div class="col-6">
              <figure><img src="./30.png" alt="ESP32 wiring detail" class="img-card img-fluid" loading="lazy"></figure>
            </div>
            <div class="col-6">
              <figure><img src="./40.png" alt="ADC read test" class="img-card img-fluid" loading="lazy"></figure>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 3: LCD Output -->
    <section class="mb-4" aria-label="LCD Output">
      <h4 class="mb-2">3) Output Device: LCD Timer Display (16×2)</h4>
      <p class="h6 lh-base">
        First time using an LCD — and I got a Pomodoro-style 25-minute countdown working. The screen
        shows instructions and updates once per second using <code>millis()</code> (no <code>delay()</code>).
      </p>
      <div class="row gallery-gap">
        <div class="col-12 col-md-6 col-lg-4">
          <figure><img src="./wa.png" alt="LCD wired on breadboard" class="img-card img-fluid" loading="lazy"></figure>
        </div>
      </div>
    </section>

    <!-- Section 4: Code Structure -->
    <section class="mb-4" aria-label="Code Structure">
      <h4 class="mb-2">4) Code Structure (C++ style, no <code>delay()</code>)</h4>
      <ul class="h6">
        <li>Rolling average on the charger pin to confirm real charging</li>
        <li>Simple state machine: <em>waiting</em> → <em>charging</em> → <em>timer</em></li>
        <li>LCD only updates on state change or countdown tick</li>
      </ul>

      <h4 class="mt-3 mb-2">Here is a code snippet</h4>
      <pre><code class="language-cpp">
#include &lt;LiquidCrystal.h&gt;

const int rs = 23, en = 22, d4 = 21, d5 = 19, d6 = 18, d7 = 16;
LiquidCrystal lcd(rs, en, d4, d5, d6, d7); // Charger pin and thresholds
const int chargerPin = 14;
const int chargeOnThreshold = 520;
const int chargeOffThreshold = 480;

// Rolling average filter
const int numSamples = 20;
int samples[numSamples] = {0};
int sampleIndex = 0;

// Timer logic
const unsigned long studyDuration = 25 * 60; // seconds
unsigned long countdownStart = 0;
unsigned long chargingDetectedTime = 0;
bool countdownRunning = false;

// States
enum State {
  WAITING_FOR_PHONE,
  CHARGING_DETECTED,
  TIMER_RUNNING
};

State currentState = WAITING_FOR_PHONE;
State lastDisplayedState = TIMER_RUNNING;

void setup() {
  lcd.begin(16, 2);
  pinMode(chargerPin, INPUT);

  lcd.setCursor(0, 0);
  lcd.print("Waiting for");
  lcd.setCursor(0, 1);
  lcd.print("phone...");
}
</code></pre>
    </section>

    <!-- Oscilloscope -->
    <section class="mb-4" aria-label="Oscilloscope">
      <h4 class="mb-2">Oscilloscope</h4>
      <p class="h6 lh-base">
        I used the scope last week and again here — super helpful for finding a stable voltage range
        to decide when a phone is truly charging.
      </p>
    </section>

    <!-- Reflections -->
    <section aria-label="Reflections">
      <h4 class="mb-2">Reflections & Challenges</h4>
      <p class="h6 lh-base">
        Simple idea, lots of wiring and debugging. I accidentally wired the potentiometer
        perpendicular to the LCD instead of in parallel — that tiny mistake cost hours until I
        found it. My favorite win so far is the phone-detection logic: reading analog voltage,
        averaging it, and reacting with meaningful states. I’ll keep tuning the thresholds and
        filtering to make it bulletproof.
      </p>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
