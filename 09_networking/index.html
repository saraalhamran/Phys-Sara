<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PS70: Intro to Digital Fabrication — Week 9 (IoT)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../style.css" rel="stylesheet">
</head>

<body>
  <!-- Top Header (unchanged colors) -->
  <nav class="navbar navbar-expand-sm navbar-dark" style=" color: #EEE7E8;">
    <div class="container-fluid" style="align-items: center; justify-content: center;">
      <div class="flexrow">
        <h2 class="nav-title">Digital Fabrication - Summer 2025</h2>
      </div>
      <div class="navbar-nav">
        <h4><a class="nav-link" href="../index.html">Home</a></h4>
        <h4><a class="nav-link" href="../about.html">About</a></h4>
      </div>
    </div>
  </nav>

  <main class="container py-4 page">
    <header class="mb-3">
      <h3>Week 9: Radio, WiFi, Bluetooth (IoT)</h3>
    </header>

    <!-- Download -->
    <div class="d-flex justify-content-center mb-3">
      <a id="btn" href="buzzer_code.rtf" download>Download my code files from this week!</a>
    </div>

    <!-- Assignment -->
    <section class="mb-4" aria-label="Assignment">
      <h4 class="mb-2">Assignment: Programming something with IoT</h4>
      <div class="h6">
        I worked with Emma and Helena to explore two small but mighty IoT builds using ESP32 boards:
        <ul class="mt-2">
          <li>8-Note Piezo Noisemaker controlled through a WebSocket-connected web interface</li>
          <li>RGB LED controlled via Firebase Realtime Database + a custom HTML color picker</li>
        </ul>
      </div>
    </section>

    <!-- Project 1 -->
    <section class="mb-4" aria-label="Project 1">
      <h3 class="mb-2">Project 1: 8-Note WebSocket Piezo Buzzer</h3>
      <p class="h6">Goal: a fun, browser-based way to pick notes and hear them played in real time on a piezo buzzer attached to the ESP32—basically a tiny hardware synth.</p>

      <div class="row align-items-start gallery-gap mt-2">
        <div class="col-12 col-md-6">
          <figure><img src="./lo.JPG" alt="ESP32 with piezo setup" class="img-card img-fluid" loading="lazy"></figure>
        </div>
        <div class="col-12 col-md-6">
          <figure class="mb-0">
            <video class="img-card" width="100%" height="auto" controls>
              <source src="./rawr.mov" type="video/quicktime">
              Your browser does not support the video tag.
            </video>
          </figure>
          <figcaption class="caption">Web app sends notes → ESP32 plays them on the piezo.</figcaption>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-12 col-md-6">
          <h4 class="mb-2">Hardware used</h4>
          <ul class="h6 mb-0">
            <li>ESP32 Dev Module</li>
            <li>Piezo buzzer (GPIO 25)</li>
            <li>Breadboard + jumper wires</li>
            <li>Any Wi-Fi device to access the webpage</li>
          </ul>
        </div>
        <div class="col-12 col-md-6">
          <h4 class="mb-2">Web interface & realtime</h4>
          <ul class="h6 mb-0">
            <li><code>ESPAsyncWebServer</code> serves a simple HTML/JS page</li>
            <li><code>AsyncWebSocket</code> streams note selections instantly</li>
            <li>8 dropdowns for notes + a D3.js staff visualization</li>
            <li>Live “currently playing” feedback in the UI</li>
          </ul>
        </div>
      </div>

      <h4 class="mt-3 mb-2">How it works</h4>
      <ol class="h6">
        <li>User picks 8 notes in the browser.</li>
        <li>On “Play,” the page builds a JSON payload (<code>formatSend()</code>) and sends it over WebSocket.</li>
        <li>ESP32 (<code>handleWebSocketMessage()</code>) parses it, loads frequencies, sets <code>newRequest</code>.</li>
        <li>In <code>loop()</code> the ESP32 iterates notes, uses <code>tone()</code>, and pushes UI updates back.</li>
      </ol>
    </section>

    <!-- Project 2 -->
    <section class="mb-4" aria-label="Project 2">
      <h3 class="mb-2">Project 2: RGB LED via Firebase + Color Picker</h3>
      <p class="h6">Goal: change an RGB LED’s color from anywhere, using Firebase Realtime Database as the cloud bridge.</p>

      <div class="row mt-2">
        <div class="col-12 col-md-6">
          <h4 class="mb-2">Hardware</h4>
          <ul class="h6 mb-0">
            <li>ESP32 Dev Board</li>
            <li>Common-cathode RGB LED (or 3 discrete LEDs)</li>
            <li>Current-limiting resistors</li>
            <li>Breadboard + jumpers</li>
          </ul>
        </div>
        <div class="col-12 col-md-6">
          <h4 class="mb-2">Firebase setup</h4>
          <p class="h6 mb-0">New Firebase project + Realtime Database. ESP32 connects to Wi-Fi, listens for RGB updates, then sets PWM on R/G/B pins. Email auth worked; later we hit security-rules hiccups.</p>
        </div>
      </div>

      <h4 class="mt-3 mb-2">Challenges faced</h4>
      <p class="h6">The Firebase library fought us during install; even the ZIP route threw compile errors. We could write color data to the DB and authenticate, but the ESP32 didn’t react—likely rules or data-path issues.</p>

      <h4 class="mb-2">Progress</h4>
      <ul class="h6">
        <li>Color picker → Firebase writes confirmed</li>
        <li>LED worked once when driven manually (hardware OK)</li>
        <li>Next step: fix read logic / DB rules and add clearer serial debug</li>
      </ul>
    </section>

    <!-- Conclusion -->
    <section aria-label="Conclusion">
      <h4 class="mb-2">Conclusion</h4>
      <p class="h6">This week taught me to host interactive pages on the ESP32, stream realtime data with WebSockets, and connect microcontrollers to cloud databases. Also: cloud auth/rules can block progress fast—good docs and debug prints are everything. I want to circle back and finish the RGB pipeline end-to-end.</p>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
